---
tags:
  - GCD
  - Multithreading
  - Semaphore
---
### Описание
**Semaphore** – базовый инструмент синхронизации в [[Grand Central Dispatch|GCD]]. Semaphore позволяет нам ограничить количество потоков, которые могут единовременно обращаться к очереди. Для этого необходимо передать количество потоков в инициализатор класса DispatchSemaphore.

### Примеры
Помимо ограничения количества потоков, семафор позволяет блокировать очередь до тех пор, пока не будет вызван метод `signal`.
```swift
// Создаем очередь
let serialQueue = DispatchQueue(label: "ru.denisegaluev.serial-queue")

// Создаем семафор
let semaphore = DispatchSemaphore(value: 0)

// Усыпляем serialQueue на 5 секунд, после вызываем метод signal тем самым
serialQueue.async {
	sleep(5)
	  
	// Разблокируем семафор    
	semaphore.signal()
}

// Блокируем очередь
semaphore.wait()
```
Методы `signal` и `wait` работают по принципу инкрементирования / декрементирования внутреннего каунтера семафора (аналогично рекурсивному mutex). Это означает, что поток будет разблокирован только тогда, когда каунтер равен значению `value`, которое мы передаем в инициализатор.